#Peterson
Исходный код изменённого лока для удобства восприятия.
```cpp
void Lock(t) {
  victim = t;
  want[t] = true;
  while(want[1 - t] and victim == t)
    // wait and retry
}
```
Ниже приведён пример прохода в критическую секцию двумя потоками.

| Tread 1 | Thread 2 |
|--------|--------|
|`victim = 0`|прерывание|
|прерывание|`victim = 1` `want[1] = true` Поток проходит в критичек=скую секцию, так как `want[1 - 1]` равен `false`.|
|`want[0] = true` Поток проходит в критическую секцию, так как `victim` равен 1.|прерывание|

Лок нерабочий, так как оба потока прошли в критическую секцию.